# Настройка туннеля для Backend

## Проблема

Когда фронтенд открыт через туннель (например, xTunnel), он пытается обратиться к backend по `localhost:8000`, что не работает, так как backend находится на вашем компьютере, а не на сервере туннеля.

## Решение

Нужно создать **отдельный туннель для backend** или использовать один туннель с проксированием.

### Вариант 1: Отдельный туннель для backend (рекомендуется)

1. **Создайте второй туннель для backend:**
   ```bash
   # Для xTunnel - создайте новый туннель на порт 8000
   # URL будет что-то вроде: https://backend.xtunnel.ru
   ```

2. **Создайте файл `.env` в `project_finance_front`:**
   ```env
   VITE_API_URL=https://ваш-backend-tunnel.xtunnel.ru
   ```

3. **Перезапустите фронтенд:**
   ```bash
   npm run dev
   ```

### Вариант 2: Один туннель с проксированием (через Vite)

Можно настроить Vite для проксирования запросов к backend.

1. **Обновите `vite.config.ts`:**
   ```typescript
   export default defineConfig({
     plugins: [react()],
     server: {
       port: 5173,
       host: true,
       proxy: {
         '/api': {
           target: 'http://127.0.0.1:8000',
           changeOrigin: true,
           rewrite: (path) => path.replace(/^\/api/, '')
         }
       }
     }
   })
   ```

2. **Измените API URL на фронтенде:**
   ```typescript
   const API_BASE_URL = '/api';
   ```

### Вариант 3: Использовать тот же туннель (если поддерживает несколько портов)

Некоторые туннели позволяют проксировать несколько портов. Проверьте документацию вашего туннеля.

## Быстрое решение для тестирования

Для быстрого тестирования можно временно использовать `allow_origins=["*"]` в CORS (уже сделано) и настроить переменную окружения:

1. Создайте `.env` в `project_finance_front`:
   ```env
   VITE_API_URL=http://127.0.0.1:8000
   ```

2. Но это не сработает через туннель. Нужен отдельный туннель для backend!

## Рекомендация

**Используйте отдельный туннель для backend:**
- Фронтенд: `https://frontend.xtunnel.ru` (порт 5173)
- Backend: `https://backend.xtunnel.ru` (порт 8000)
- В `.env` фронтенда: `VITE_API_URL=https://backend.xtunnel.ru`



